<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Form [
  <!ENTITY section "margin-top: 4px;">
  <!ENTITY separator "<hr/>">
  <!ENTITY inline "display:inline-block;">
  <!ENTITY labelLeft "&inline; width:100px; padding-top:1px;">
  <!ENTITY labelRight "&inline; width:60px; padding-top:1px; text-align:right; margin-right:10px;">
  <!ENTITY input "&inline; width:110px;">
]>
<f:Form xmlns="http://www.butent.com/widget"
  xmlns:f="http://www.butent.com/form"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  
  name="Assessment" viewName="Assessments" showRowId="true"
  >
  <f:properties reports="PrintOrderLT, PrintOrderEN, PrintOrderRU" />

  <FlowPanel style="padding: 10px 2px 2px 10px;" class="flexBox-vertical bee-tr-assessment-form">
    <FlowPanel style="height:65%; overflow:auto;">
      <FlowPanel style="&section;">
        <Label for="Status" style="&labelLeft;" />
        <FlowPanel name="Status" style="&input; font-weight:bold;" />
        <Label for="Customer" style="&labelRight; width:120px;" />
        <DataSelector source="Customer" style="&input; width:200px;" />
      </FlowPanel>
      <FlowPanel style="&section;">
        <Label for="Date" style="&labelLeft;" />
        <InputDateTime source="Date" style="&input;" />
        <Label for="CustomerPerson" style="&labelRight; width:120px;" />
        <DataSelector source="CustomerPerson" style="&input; width:200px;" 
          choiceColumns="FirstName LastName CompanyName" options="Customer" />
      </FlowPanel>
    
      <FlowPanel style="&section;">
        <Label text="=refNumber" for="Number" style="&labelLeft;" />
        <InputText source="Number" style="&input;" />
        <Label text="=shipper" for="Shipper" style="&labelRight; width:120px;" />
        <InputText source="Shipper" style="&input; width:200px;" />
      </FlowPanel>
    
      &separator;
      <xi:include href="widgets/CargoInfo.widget.xml" />

      &separator;
      <FlowPanel style="&section;">
        <Label for="Manager" class="bee-required" style="&labelLeft;" />
        <DataSelector name="Manager" source="Manager" style="&input; width:200px;" caching="local"
          viewName="AssessmentExecutors" choiceColumns="LastName FirstName DepartmentName"
          editSource="CompanyPerson" newRowEnabled="false" required="true" />
        <Label for="DepartmentName" style="&inline; margin:0 10px 0 10px; padding-top:1px;" />
        <TextLabel source="DepartmentName" style="&inline; padding-top:1px; font-weight:bold;" />
      </FlowPanel>
      <FlowPanel style="&section;">
        <Label text="=trComment" for="Notes" style="&labelLeft; vertical-align:top;" />
        <InputArea source="Notes" style="width:400px;" />
      </FlowPanel>

      &separator;
      <FlowPanel style="&section;">
        <Label for="Currency" class="bee-required" style="&labelLeft;" />
        <DataSelector name="Currency" source="Currency" required="true"
          style="&inline; width:40px; margin-right:20px;" editEnabled="false" />
                  
        <FlowPanel style="&inline; &section;">
          <InlineLabel text="=customerPrice" style="padding-top:1px; margin-right:10px;" />
          <InlineLabel name="IncomeTotal" style="font-weight:bold; margin-right:20px;" />
          <InlineLabel text="=transportCost" style="padding-top:1px; margin-right:10px;" />
          <InlineLabel name="ExpenseTotal" style="font-weight:bold; margin-right:20px;" />
          <InlineLabel text="=profit" style="padding-top:1px; margin-right:10px;" />
          <InlineLabel name="Profit" style="font-weight:bold;" />
        </FlowPanel>
      </FlowPanel>

      &separator;
      <FlowPanel style="&section;">
        <Label text="=crmTaskObservers" style="&labelLeft;" />
        <ChildSelector childTable="AssessmentObservers" viewName="AssessmentExecutors"
          targetRelColumn="Assessment" sourceRelColumn="User"
          choiceColumns="FirstName LastName DepartmentName" renderColumns="FirstName LastName"
          editEnabled="false" newRowEnabled="false" caching="local"
          style="&inline; width:400px;" label="=crmTaskObservers" />
      </FlowPanel>
      <FlowPanel style="&section;">
        <Label text="=crmTaskObserverGroups" style="&labelLeft;" />
        <ChildSelector childTable="AssessmentOGroups" viewName="UserGroupSettings"
          targetRelColumn="Assessment" sourceRelColumn="Group" renderColumns="Name"
          editPopup="true" newRowEnabled="false" style="&inline; width:400px;"
          label="=crmTaskObserverGroups" filter="Owner {u} or Visibility" />
      </FlowPanel>
      &separator;
    </FlowPanel>

    <TabbedPages class="flexible" style="&section; min-height:100px;">
      <page data="AssessmentForwarders">
        <text>=carriers</text>
        <ChildGrid name="AssessmentForwarders" relColumn="Assessment" />
      </page>
      <page data="CargoIncomes">
        <FlowPanel>
          <Label text="=income" style="&inline;" />
          <FlowPanel name="Income" style="&inline;" />
        </FlowPanel>
        <ChildGrid name="CargoIncomes" relColumn="Cargo" source="Cargo" />
      </page>
      <page data="CargoExpenses">
        <FlowPanel>
          <CheckBox name="ExpensesRegistered" source="ExpensesRegistered" html="-"
            title="=trExpensesRegistered" style="&inline; margin:0 5px 0 0; position:relative; top:4px;" />
          <Label text="=trExpenses" style="&inline;" />
          <FlowPanel name="Expense" style="&inline;" />
        </FlowPanel>
        <ChildGrid name="CargoExpenses" relColumn="Cargo" source="Cargo" />
      </page>
      <page data="ChildAssessments">
        <text>=assessments</text>
        <ChildGrid name="ChildAssessments" relColumn="Assessment" />
      </page>
    </TabbedPages>
  </FlowPanel>
</f:Form>
