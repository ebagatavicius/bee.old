<?xml version="1.0" encoding="UTF-8"?>
<View xmlns="http://www.butent.com/view"

  name="Places" source="Places"
  >
  <Columns>
    <HiddenColumn name="Folder" />
    <SimpleColumn name="Flags" />
    <SimpleColumn name="Message" />

    <SimpleJoin name="Message" joinType="INNER">
      <SimpleColumn name="Date" />
      <SimpleColumn name="Subject" />
      <SimpleColumn name="AttachmentCount" />
      <SimpleColumn name="Sender" />

      <SimpleJoin name="Sender" joinType="LEFT">
        <SimpleColumn name="Email" alias="SenderEmail" />
        <ExternalJoin name="Email" source="Addressbook" joinType="LEFT">
          <SimpleColumn name="Label" alias="SenderLabel" />
        </ExternalJoin>
      </SimpleJoin>

      <ExternalJoin name="Message" source="Recipients" joinType="LEFT">
        <AggregateColumn name="Address" alias="RecipientCount" aggregate="COUNT" />

        <SimpleJoin name="Address" joinType="LEFT">
          <AggregateColumn name="Email" alias="RecipientEmail" aggregate="MAX" />
          <ExternalJoin name="Email" source="Addressbook" joinType="LEFT">
            <AggregateColumn name="Label" alias="RecipientLabel" aggregate="MAX" />
          </ExternalJoin>
        </SimpleJoin>
      </ExternalJoin>
    </SimpleJoin>
    </Columns>
  <Order>
    <OrderBy column="Date" descending="true" />
  </Order>
</View>
 